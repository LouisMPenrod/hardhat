<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a new preprocessing blueprint — new_formula_blueprint • hardhat</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet"><!--optional theme--><link href="../tidymodels.css" rel="stylesheet"><meta property="og:title" content="Create a new preprocessing blueprint — new_formula_blueprint"><meta property="og:description" content="These are the base classes for creating new preprocessing blueprints. All
blueprints inherit from the one created by new_blueprint(), and the default
method specific blueprints inherit from the other three here.
If you want to create your own processing blueprint for a specific method,
generally you will subclass one of the method specific blueprints here. If
you want to create a completely new preprocessing blueprint for a totally new
preprocessing method (i.e. not the formula, xy, or recipe method) then
you should subclass new_blueprint()."><meta property="og:image" content="https://hardhat.tidymodels.org/logo.png"><meta name="twitter:card" content="summary"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">hardhat</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://github.com/tidymodels" class="external-link">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.6.9001</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/forge.html">Forging data for predictions</a>
    </li>
    <li>
      <a href="../articles/mold.html">Molding data for modeling</a>
    </li>
    <li>
      <a href="../articles/package.html">Creating Modeling Packages With hardhat</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2019/12/hardhat-0-1-0/" class="external-link">Version 0.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul></li>
        <li>
  <a href="https://github.com/tidymodels/hardhat/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a new preprocessing blueprint</h1>
    <small class="dont-index">Source: <a href="https://github.com/tidymodels/hardhat/blob/HEAD/R/blueprint-formula.R" class="external-link"><code>R/blueprint-formula.R</code></a>, <a href="https://github.com/tidymodels/hardhat/blob/HEAD/R/blueprint-recipe.R" class="external-link"><code>R/blueprint-recipe.R</code></a>, <a href="https://github.com/tidymodels/hardhat/blob/HEAD/R/blueprint-xy.R" class="external-link"><code>R/blueprint-xy.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>new-blueprint.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These are the base classes for creating new preprocessing blueprints. All
blueprints inherit from the one created by <code>new_blueprint()</code>, and the default
method specific blueprints inherit from the other three here.</p>
<p>If you want to create your own processing blueprint for a specific method,
generally you will subclass one of the method specific blueprints here. If
you want to create a completely new preprocessing blueprint for a totally new
preprocessing method (i.e. not the formula, xy, or recipe method) then
you should subclass <code>new_blueprint()</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">new_formula_blueprint</span><span class="op">(</span>
  <span class="va">mold</span>,
  <span class="va">forge</span>,
  intercept <span class="op">=</span> <span class="cn">FALSE</span>,
  allow_novel_levels <span class="op">=</span> <span class="cn">FALSE</span>,
  ptypes <span class="op">=</span> <span class="cn">NULL</span>,
  formula <span class="op">=</span> <span class="cn">NULL</span>,
  indicators <span class="op">=</span> <span class="st">"traditional"</span>,
  composition <span class="op">=</span> <span class="st">"tibble"</span>,
  <span class="va">...</span>,
  subclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">new_recipe_blueprint</span><span class="op">(</span>
  <span class="va">mold</span>,
  <span class="va">forge</span>,
  intercept <span class="op">=</span> <span class="cn">FALSE</span>,
  allow_novel_levels <span class="op">=</span> <span class="cn">FALSE</span>,
  fresh <span class="op">=</span> <span class="cn">TRUE</span>,
  composition <span class="op">=</span> <span class="st">"tibble"</span>,
  ptypes <span class="op">=</span> <span class="cn">NULL</span>,
  recipe <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  subclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">new_xy_blueprint</span><span class="op">(</span>
  <span class="va">mold</span>,
  <span class="va">forge</span>,
  intercept <span class="op">=</span> <span class="cn">FALSE</span>,
  allow_novel_levels <span class="op">=</span> <span class="cn">FALSE</span>,
  composition <span class="op">=</span> <span class="st">"tibble"</span>,
  ptypes <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  subclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">new_blueprint</span><span class="op">(</span>
  <span class="va">mold</span>,
  <span class="va">forge</span>,
  intercept <span class="op">=</span> <span class="cn">FALSE</span>,
  allow_novel_levels <span class="op">=</span> <span class="cn">FALSE</span>,
  composition <span class="op">=</span> <span class="st">"tibble"</span>,
  ptypes <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  subclass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mold</dt>
<dd><p>A named list with two elements, <code>clean</code> and <code>process</code>, see
the <code>new_blueprint()</code> section, Mold Functions, for details.</p></dd>
<dt>forge</dt>
<dd><p>A named list with two elements, <code>clean</code> and <code>process</code>, see
the <code>new_blueprint()</code> section, Forge Functions, for details.</p></dd>
<dt>intercept</dt>
<dd><p>A logical. Should an intercept be included in the
processed data? This information is used by the <code>process</code> function
in the <code>mold</code> and <code>forge</code> function list.</p></dd>
<dt>allow_novel_levels</dt>
<dd><p>A logical. Should novel factor levels be allowed at
prediction time? This information is used by the <code>clean</code> function in the
<code>forge</code> function list, and is passed on to <code><a href="scream.html">scream()</a></code>.</p></dd>
<dt>ptypes</dt>
<dd><p>Either <code>NULL</code>, or a named list with 2 elements, <code>predictors</code>
and <code>outcomes</code>, both of which are 0-row tibbles. <code>ptypes</code> is generated
automatically at <code><a href="mold.html">mold()</a></code> time and is used to validate <code>new_data</code> at
prediction time. At <code><a href="mold.html">mold()</a></code> time, the information found in
<code>blueprint$mold$process()$ptype</code> is used to set <code>ptypes</code> for the <code>blueprint</code>.</p></dd>
<dt>formula</dt>
<dd><p>Either <code>NULL</code>, or a formula that specifies how the
predictors and outcomes should be preprocessed. This argument is set
automatically at <code><a href="mold.html">mold()</a></code> time.</p></dd>
<dt>indicators</dt>
<dd><p>A single character string. Control how factors are
expanded into dummy variable indicator columns. One of:</p><ul><li><p><code>"traditional"</code> - The default. Create dummy variables using the
traditional <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> infrastructure. Generally this creates
<code>K - 1</code> indicator columns for each factor, where <code>K</code> is the number of
levels in that factor.</p></li>
<li><p><code>"none"</code> - Leave factor variables alone. No expansion is done.</p></li>
<li><p><code>"one_hot"</code> - Create dummy variables using a one-hot encoding approach
that expands unordered factors into all <code>K</code> indicator columns, rather than
<code>K - 1</code>.</p></li>
</ul></dd>
<dt>composition</dt>
<dd><p>Either "tibble", "matrix", or "dgCMatrix" for the format
of the processed predictors. If "matrix" or "dgCMatrix" are chosen, all of
the predictors must be numeric after the preprocessing method has been
applied; otherwise an error is thrown.</p></dd>
<dt>...</dt>
<dd><p>Name-value pairs for additional elements of blueprints that
subclass this blueprint.</p></dd>
<dt>subclass</dt>
<dd><p>A character vector. The subclasses of this blueprint.</p></dd>
<dt>fresh</dt>
<dd><p>Should already trained operations be re-trained when <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code> is
called?</p></dd>
<dt>recipe</dt>
<dd><p>Either <code>NULL</code>, or an unprepped recipe. This argument is set
automatically at <code><a href="mold.html">mold()</a></code> time.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A preprocessing blueprint, which is a list containing the inputs used as
arguments to the function, along with a class specific to the type
of blueprint being created.</p>
    </div>
    <div id="mold-functions">
    <h2>Mold Functions</h2>
    


<p><code>blueprint$mold</code> should be a named list with two elements, both of which
are functions:</p><ul><li><p><code>clean</code>: A function that performs initial cleaning of the user's input
data to be used in the model.</p><ul><li><p><em>Arguments</em>:</p><ul><li><p>If this is an xy blueprint, <code>blueprint</code>, <code>x</code> and <code>y</code>.</p></li>
<li><p>Otherwise, <code>blueprint</code> and <code>data</code>.</p></li>
</ul></li>
<li><p><em>Output</em>: A named list of three elements:</p><ul><li><p><code>blueprint</code>: The blueprint, returned and potentially updated.</p></li>
<li><p>If using an xy blueprint:</p><ul><li><p><code>x</code>: The cleaned predictor data.</p></li>
<li><p><code>y</code>: The cleaned outcome data.</p></li>
</ul></li>
<li><p>If not using an xy blueprint:</p><ul><li><p><code>data</code>: The cleaned data.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><code>process</code>: A function that performs the actual preprocessing of the data.</p><ul><li><p><em>Arguments</em>:</p><ul><li><p>If this is an xy blueprint, <code>blueprint</code>, <code>x</code> and <code>y</code>.</p></li>
<li><p>Otherwise, <code>blueprint</code> and <code>data</code>.</p></li>
</ul></li>
<li><p><em>Output</em>: A named list of 5 elements:</p><ul><li><p><code>blueprint</code>: The blueprint, returned and potentially updated.</p></li>
<li><p><code>predictors</code>: A tibble of predictors.</p></li>
<li><p><code>outcomes</code>: A tibble of outcomes.</p></li>
<li><p><code>ptypes</code>: A named list with 2 elements, <code>predictors</code> and <code>outcomes</code>,
where both elements are 0-row tibbles.</p></li>
<li><p><code>extras</code>: Varies based on the blueprint. If the blueprint has no
extra information, <code>NULL</code>. Otherwise a named list of the
extra elements returned by the blueprint.</p></li>
</ul></li>
</ul></li>
</ul><p>Both <code>blueprint$mold$clean()</code> and <code>blueprint$mold$process()</code> will be called,
in order, from <code><a href="mold.html">mold()</a></code>.</p>
    </div>
    <div id="forge-functions">
    <h2>Forge Functions</h2>
    


<p><code>blueprint$forge</code> should be a named list with two elements, both of which
are functions:</p><ul><li><p><code>clean</code>: A function that performs initial cleaning of <code>new_data</code>:</p><ul><li><p><em>Arguments</em>:</p><ul><li><p><code>blueprint</code>, <code>new_data</code>, and <code>outcomes</code>.</p></li>
</ul></li>
<li><p><em>Output</em>: A named list of the following elements:</p><ul><li><p><code>blueprint</code>: The blueprint, returned and potentially updated.</p></li>
<li><p><code>predictors</code>: A tibble containing the cleaned predictors.</p></li>
<li><p><code>outcomes</code>: A tibble containing the cleaned outcomes.</p></li>
<li><p><code>extras</code>: A named list of any extras obtained while cleaning. These
are passed on to the <code>process()</code> function for further use.</p></li>
</ul></li>
</ul></li>
<li><p><code>process</code>: A function that performs the actual preprocessing of the data
using the known information in the <code>blueprint</code>.</p><ul><li><p><em>Arguments</em>:</p><ul><li><p><code>blueprint</code>, <code>new_data</code>, <code>outcomes</code>, <code>extras</code>.</p></li>
</ul></li>
<li><p><em>Output</em>: A named list of the following elements:</p><ul><li><p><code>blueprint</code>: The blueprint, returned and potentially updated.</p></li>
<li><p><code>predictors</code>: A tibble of the predictors.</p></li>
<li><p><code>outcomes</code>: A tibble of the outcomes, or <code>NULL</code>.</p></li>
<li><p><code>extras</code>: Varies based on the blueprint. If the blueprint has no
extra information, <code>NULL</code>. Otherwise a named list of the
extra elements returned by the blueprint.</p></li>
</ul></li>
</ul></li>
</ul><p>Both <code>blueprint$forge$clean()</code> and <code>blueprint$forge$process()</code> will be called,
in order, from <code><a href="forge.html">forge()</a></code>.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="tidyverse">
  <p>hardhat is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer></div>

  


  

  </body></html>

